import{aJ as t,bz as e,ba as a,bi as r,b3 as n,aW as o,aX as s,a_ as i,bk as l,a$ as d,aV as c,bA as v,aO as p,by as u,bB as g,b4 as f,bC as m,bD as h,aY as b,aT as w,aU as y,b1 as $,aS as x,bx as A,b2 as C,bE as P,b9 as L,b8 as j,b6 as N,bg as B}from"../chunks/Cz_4NaLz.js";var D=e('<g><text font-size="90%" text-anchor="end" dominant-baseline="middle"> </text><g><rect class="votes svelte-a7xju3"></rect></g><text font-size="90%" dominant-baseline="middle"> </text></g>'),T=e('<svg width="100%"><g></g></svg>');function O(e,b){t(b,!0);const w=[...b.report.candidates].sort((t,e)=>e.votes-t.votes),y=Math.max(...w.map(t=>t.votes)),$=b.report.ballotCount,x=420/y,A=24*w.length;var C=T(),P=i(C);a(P,"transform","translate(130 0)"),r(P,21,()=>w,l,(t,e,r)=>{var s=D();a(s,"transform",`translate(0 ${24*(r+.5)})`);var l=i(s),b=i(l,!0);d(l);var w=c(l);a(w,"transform","translate(5 -8)");var y=i(w);a(y,"height",14),v(y,(t,e)=>function(t,e){if(null===e)return;m(t,{content:e,allowHTML:!0,theme:"light-border",plugins:[h],followCursor:!0})}?.(t,e),()=>`<strong>${p(e).name}</strong>\n            received <strong>${p(e).votes.toLocaleString()}</strong> votes, ${(p(e).votes/$*100).toFixed(1)}% of the total ballots cast.</g>`),d(w);var A=c(w),C=i(A);d(A),d(s),n(t=>{u(s,0,g(!0===p(e).winner?"":"eliminated"),"svelte-a7xju3"),f(b,p(e).name),a(y,"width",x*p(e).votes),a(A,"x",10+x*p(e).votes),f(C,`${t??""}%`)},[()=>(p(e).votes/$*100).toFixed(1)]),o(t,s)}),d(P),d(C),n(()=>a(C,"viewBox",`0 0 600 ${A}`)),o(e,C),s()}function F(t,e){if(null===e)return;m(t,{content:e,allowHTML:!0,theme:"light-border",plugins:[h],followCursor:!0})}var M=x('<td class="colLabel approval-col-label svelte-fan315"><div class="svelte-fan315"> </div></td>'),S=x('<td class="entry svelte-fan315"><!></td>'),E=x('<tr><td class="rowLabel svelte-fan315"> <div class="voter-count svelte-fan315"> </div></td><!></tr>'),k=x('<table class="svelte-fan315"><tbody><tr><td></td><td class="colsLabel svelte-fan315">Number of Candidates Approved</td></tr><tr><td class="rowsLabel svelte-fan315"><div class="svelte-fan315">Candidate</div></td><td></td><!></tr><!></tbody></table>');var z=x('<td class="colLabel svelte-1ncug9c"><div class="svelte-1ncug9c"> </div></td>'),I=x('<td class="entry svelte-1ncug9c"><!></td>'),R=x('<tr><td class="rowLabel svelte-1ncug9c"> </td><!></tr>'),V=x('<table class="svelte-1ncug9c"><tbody><tr><td></td><td class="colsLabel svelte-1ncug9c">Also approved</td></tr><tr><td class="rowsLabel svelte-1ncug9c"><div class="svelte-1ncug9c">Approved</div></td><td></td><!></tr><!></tbody></table>');function H(e,u){t(u,!0);const g=$(()=>()=>{if(u.votingPatterns?.candidateApprovalDistributions){return u.candidates.map(t=>{const e=u.votingPatterns.candidateApprovalDistributions?.[t];return{name:t,votes:e?Object.values(e).reduce((t,e)=>t+e,0):0}}).sort((t,e)=>e.votes-t.votes).map(t=>t.name)}return[...u.candidates]}),m=$(()=>()=>({rows:p(g)().map((t,e)=>e),cols:p(g)().map((t,e)=>e),entries:p(g)().map((t,e)=>p(g)().map((a,r)=>{if(e===r)return null;const n=u.coApprovals.find(e=>e.candidateA.toLowerCase()===t.toLowerCase()&&e.candidateB.toLowerCase()===a.toLowerCase());return n?{frac:n.coApprovalRate/100,numerator:n.coApprovalCount,denominator:Math.round(n.coApprovalCount/(n.coApprovalRate/100))}:null}))})),h=$(()=>()=>{let t=0;return p(m)().entries.forEach(e=>{e.forEach(e=>{e&&e.frac>t&&(t=e.frac)})}),t});var b=V(),w=i(b),x=i(w),P=c(i(x));d(x);var L=c(x),j=i(L),N=c(j,2);r(N,17,()=>p(g)(),l,(t,e)=>{var a=z(),r=i(a),s=i(r,!0);d(r),d(a),n(()=>f(s,p(e))),o(t,a)}),d(L);var B=c(L);r(B,17,()=>p(g)(),l,(t,e,a)=>{var s=R(),u=i(s),b=i(u,!0);d(u);var w=c(u);r(w,17,()=>p(g)(),l,(t,r,s)=>{const l=$(()=>p(m)().entries[a][s]);var c=I(),u=i(c),g=t=>{var e=C();n(t=>f(e,`${t??""}%`),[()=>Math.round(1e3*p(l).frac)/10]),o(t,e)},b=t=>{var e=C("—");o(t,e)};y(u,t=>{p(l)?t(g):t(b,!1)}),d(c),v(c,(t,e)=>F?.(t,e),()=>p(l)?function(t,e,a){return`${(100*a.frac).toFixed(1)}% of ${t} voters also approved ${e} (${a.numerator.toLocaleString()} of ${a.denominator.toLocaleString()})`}(p(e),p(r),p(l)):null),n(t=>A(c,t),[()=>{return p(l)?"background: "+(t=p(l).frac,`hsl(99, 41%, ${function(t,e,a){return t*(1-a)+e*a}(97,65,p(h)()>0?t/p(h)():0)}%)`):"";var t}]),o(t,c)}),d(s),n(()=>f(b,p(e))),o(t,s)}),d(w),d(b),n((t,e)=>{a(P,"colspan",t),a(j,"rowspan",e)},[()=>p(g)().length,()=>p(g)().length+1]),o(e,b),s()}var J=e('<g><text font-size="90%" text-anchor="end" dominant-baseline="middle"> </text><g><rect class="exclusions svelte-1ds3g8f"></rect></g><text font-size="90%" dominant-baseline="middle"> </text></g>'),U=x('<div class="anyone-but-chart svelte-1ds3g8f"><div class="chart-title svelte-1ds3g8f">Anyone but...</div> <svg width="100%"><g></g></svg></div>'),Y=x('<div class="no-data svelte-1ds3g8f">No "Anyone But" voting patterns detected (no ballots with exactly N-1 approvals)</div>');function _(e,u){t(u,!0);const g=$(()=>()=>{if(!u.votingPatterns?.anyoneButAnalysis)return null;const t=Object.values(u.votingPatterns.anyoneButAnalysis).reduce((t,e)=>t+e,0),e=u.votingPatterns.totalBallots||0;if(0===t)return null;const a=u.candidates.map(a=>({name:a,exclusionCount:u.votingPatterns.anyoneButAnalysis[a]||0,exclusionRate:t>0?(u.votingPatterns.anyoneButAnalysis[a]||0)/t*100:0,overallRate:e>0?(u.votingPatterns.anyoneButAnalysis[a]||0)/e*100:0})).sort((t,e)=>e.exclusionCount-t.exclusionCount),r=Math.max(...a.map(t=>t.exclusionCount));return{data:a,totalExclusions:t,totalBallots:e,maxExclusions:r,scale:420/r}}),x=$(()=>()=>{const t=p(g)();return t?24*t.data.length:0});var A=b(),C=w(A),P=t=>{const e=$(()=>p(g)());var s=U(),u=c(i(s),2),b=i(u);a(b,"transform","translate(130 0)"),r(b,21,()=>p(e).data,l,(t,r,s)=>{var l=J();a(l,"transform",`translate(0 ${24*(s+.5)})`);var u=i(l),g=i(u,!0);d(u);var b=c(u);a(b,"transform","translate(5 -8)");var w=i(b);a(w,"height",14),v(w,(t,e)=>function(t,e){if(null===e)return;m(t,{content:e,allowHTML:!0,theme:"light-border",plugins:[h],followCursor:!0})}?.(t,e),()=>`<strong>${p(r).name}</strong> was excluded by <strong>${p(r).exclusionCount.toLocaleString()}</strong> voters who approved all other candidates, ${p(r).overallRate.toFixed(1)}% of all ballots cast.`),d(b);var y=c(b),$=i(y);d(y),d(l),n(t=>{f(g,p(r).name),a(w,"width",p(e).scale*p(r).exclusionCount),a(y,"x",10+p(e).scale*p(r).exclusionCount),f($,`${t??""}%`)},[()=>p(r).exclusionRate.toFixed(1)]),o(t,l)}),d(b),d(u),d(s),n(t=>a(u,"viewBox",t),[()=>`0 0 600 ${p(x)()}`]),o(t,s)},L=t=>{var e=Y();o(t,e)};y(C,t=>{p(g)()?t(P):t(L,!1)}),o(e,A),s()}var W=x("<a> </a>"),X=x("<strong> </strong>"),q=x(", and <strong> </strong>",1),G=x(", <strong> </strong>",1),K=x("<p><strong> </strong> </p>"),Q=x('<div class="row"><div class="leftCol"><h2>"Anyone But" Analysis</h2> <p>This shows which candidates were excluded when voters approved all candidates except one.\n      These ballots reveal strong opposition patterns, where voters are saying\n      "I\'ll support anyone except this candidate."</p> <!></div> <div class="rightCol"><!></div></div>'),Z=x('<div class="row"><div class="leftCol"><h2>Approval Distribution</h2> <p>This shows how many candidates voters approved, both overall and broken down by\n      each candidate\'s supporters. This reveals whether some candidates attracted voters\n      who approved multiple candidates versus those who approved fewer candidates.\n      In approval voting, voters can select as many candidates as they wish.</p></div> <div class="rightCol"><!></div></div> <div class="row"><div class="leftCol"><h2>Co-Approval Matrix</h2> <p>For every pair of candidates, this table shows the fraction of voters who\n      approved one candidate that also approved the other. This reveals voting\n      patterns and candidate coalitions.</p></div> <div class="rightCol"><!></div></div> <!>',1),tt=x('<div class="row"><p class="description"></p> <div class="electionHeader"><h1><a>approval.vote</a> // <strong> </strong> </h1></div></div> <div class="row"><div class="leftCol"><p>The <!> was held on <strong> </strong>. <!> <!> <strong> </strong> <!>. <!></p> <p>There were <strong> </strong> ballots, with <strong> </strong> approvals. There was an average of <strong> </strong> approvals per ballot in this race.</p></div> <div class="rightCol"><!></div></div> <!>',1);function et(e,m){t(m,!0),P("candidates",{getCandidate:function(t){return m.report.candidates[t]}});const h=m.report.candidates.map(t=>t.votes).reduce((t,e)=>t+e),x=m.report.candidates.filter(t=>!t.writeIn).length;var N=tt(),B=w(N),D=c(i(B),2),T=i(D),z=i(T),I=c(z,2),R=i(I,!0);d(I);var V=c(I);d(T),d(D),d(B);var J=c(B,2),U=i(J),Y=i(U),et=c(i(Y)),at=t=>{var e=W(),r=i(e);d(e),n(()=>{a(e,"href",m.report.info.website),f(r,`${m.report.info.jurisdictionName??""}\n          ${m.report.info.electionName??""}`)}),o(t,e)},rt=t=>{var e=C();n(()=>f(e,`${m.report.info.jurisdictionName??""} ${m.report.info.electionName??""}`)),o(t,e)};y(et,t=>{m.report.info.website?t(at):t(rt,!1)});var nt=c(et,2),ot=i(nt,!0);d(nt);var st=c(nt,2);r(st,17,()=>{return 1==(t=m.report.candidates).length?[m.report.candidates[0]]:t.filter(t=>!0===t.winner);var t},l,(t,e,a)=>{var r=b(),s=w(r),l=t=>{var a=X(),r=i(a,!0);d(a),n(()=>f(r,p(e).name)),o(t,a)},v=t=>{var r=b(),s=w(r),l=t=>{var a=q(),r=c(w(a)),s=i(r,!0);d(r),n(()=>f(s,p(e).name)),o(t,a)},v=t=>{var a=G(),r=c(w(a)),s=i(r,!0);d(r),n(()=>f(s,p(e).name)),o(t,a)};y(s,t=>{a==m.report.winners.length-1?t(l):t(v,!1)},!0),o(t,r)};y(s,t=>{0==a?t(l):t(v,!1)}),o(t,r)});var it=c(st,2),lt=t=>{var e=C("was the winner out of");o(t,e)},dt=t=>{var e=C("were the winners out of");o(t,e)};y(it,t=>{1==m.report.winners.length?t(lt):t(dt,!1)});var ct=c(it,2),vt=i(ct,!0);d(ct);var pt=c(ct,2),ut=t=>{var e=C("candidate");o(t,e)},gt=t=>{var e=C("candidates");o(t,e)};y(pt,t=>{1==x?t(ut):t(gt,!1)});var ft=c(pt,2),mt=t=>{var e=C();n(()=>f(e,m.report.info.notes)),o(t,e)};y(ft,t=>{m.report.info.notes&&t(mt)}),d(Y);var ht=c(Y,2),bt=c(i(ht)),wt=i(bt,!0);d(bt);var yt=c(bt,2),$t=i(yt,!0);d(yt);var xt=c(yt,2),At=i(xt,!0);d(xt),j(),d(ht),d(U);var Ct=c(U,2);O(i(Ct),{get report(){return m.report}}),d(Ct),d(J);var Pt=c(J,2),Lt=e=>{var h=Z(),x=w(h),P=c(i(x),2),L=i(P);{let e=$(()=>m.report.candidates.map(t=>t.name));!function(e,m){t(m,!0);const h=$(()=>()=>m.votingPatterns?.candidateApprovalDistributions?m.candidates.map(t=>{const e=m.votingPatterns.candidateApprovalDistributions?.[t];return{name:t,votes:e?Object.values(e).reduce((t,e)=>t+e,0):0}}).sort((t,e)=>e.votes-t.votes).map(t=>t.name):[...m.candidates]),x=$(()=>()=>{const t=[];if(m.votingPatterns?.approvalDistribution&&m.votingPatterns?.candidateApprovalDistributions){const e={},a=m.votingPatterns.totalBallots;Object.entries(m.votingPatterns.approvalDistribution).forEach(([t,r])=>{const n=parseInt(t);e[n]={count:r,percentage:r/a*100}}),t.push({candidateName:"All Candidates",isOverall:!0,totalVoters:a,distributions:e});for(const r of p(h)()){const e=m.votingPatterns.candidateApprovalDistributions[r];if(!e)continue;const a=Object.values(e).reduce((t,e)=>t+e,0),n={};Object.entries(e).forEach(([t,e])=>{const r=parseInt(t);n[r]={count:e,percentage:e/a*100}}),t.push({candidateName:r,isOverall:!1,totalVoters:a,distributions:n})}}return t}),P=$(()=>()=>{let t=0;return m.votingPatterns?.approvalDistribution&&Object.keys(m.votingPatterns.approvalDistribution).forEach(e=>{t=Math.max(t,parseInt(e))}),t});var L=b(),j=w(L),N=t=>{const e=$(()=>p(x)()),s=$(()=>p(P)());var m=k(),h=i(m),b=i(h),w=c(i(b));d(b);var L=c(b),j=i(L),N=c(j,2);r(N,17,()=>Array.from({length:p(s)},(t,e)=>e+1),l,(t,e)=>{var a=M(),r=i(a),s=i(r,!0);d(r),d(a),n(()=>f(s,p(e))),o(t,a)}),d(L);var B=c(L);r(B,17,()=>p(e),l,(t,e)=>{var a=E(),m=i(a),h=i(m),b=c(h),w=i(b);d(b),d(m);var $=c(m);r($,17,()=>Array.from({length:p(s)},(t,e)=>e+1),l,(t,a)=>{var r=S(),s=i(r),l=t=>{var r=C();n(t=>f(r,`${t??""}%`),[()=>p(e).distributions[p(a)].percentage.toFixed(1)]),o(t,r)},c=t=>{var e=C("—");o(t,e)};y(s,t=>{p(e).distributions[p(a)]?t(l):t(c,!1)}),d(r),v(r,(t,e)=>F?.(t,e),()=>p(e).distributions[p(a)]?function(t,e){const a=t.distributions[e];return a?`${t.candidateName}: ${a.count.toLocaleString()} voters (${a.percentage.toFixed(1)}%) approved exactly ${e} candidate${1!==e?"s":""}`:""}(p(e),p(a)):null),n(()=>A(r,p(e).distributions[p(a)]?`background: hsl(99, 41%, ${97-.8*p(e).distributions[p(a)].percentage}%)`:"")),o(t,r)}),d(a),n(t=>{u(a,1,g(p(e).isOverall?"overall-separator":""),"svelte-fan315"),f(h,`${p(e).candidateName??""} `),f(w,`(${t??""} voters)`)},[()=>p(e).totalVoters.toLocaleString()]),o(t,a)}),d(h),d(m),n(()=>{a(w,"colspan",p(s)+1),a(j,"rowspan",p(e).length+1)}),o(t,m)};y(j,t=>{p(x)().length>0&&t(N)}),o(e,L),s()}(L,{get candidates(){return p(e)},get votingPatterns(){return m.report.votingPatterns}})}d(P),d(x);var j=c(x,2),N=c(i(j),2),B=i(N);{let t=$(()=>m.report.candidates.map(t=>t.name));H(B,{get coApprovals(){return m.report.coApprovals},get candidates(){return p(t)},get votingPatterns(){return m.report.votingPatterns}})}d(N),d(j);var D=c(j,2),T=t=>{var e=Q(),a=i(e),r=c(i(a),4),s=t=>{const e=$(()=>Object.values(m.report.votingPatterns.anyoneButAnalysis).reduce((t,e)=>t+e,0));var a=K(),r=i(a),s=i(r,!0);d(r);var l=c(r);d(a),n((t,e)=>{f(s,t),f(l,` ballots approved all but one candidate\n        (${e??""}% of all ballots).`)},[()=>p(e).toLocaleString(),()=>(p(e)/m.report.ballotCount*100).toFixed(1)]),o(t,a)};y(r,t=>{m.report.votingPatterns?.anyoneButAnalysis&&t(s)}),d(a);var l=c(a,2),v=i(l);{let t=$(()=>m.report.candidates.map(t=>t.name));_(v,{get candidates(){return p(t)},get votingPatterns(){return m.report.votingPatterns}})}d(l),d(e),o(t,e)};y(D,t=>{m.report.votingPatterns?.anyoneButAnalysis&&t(T)}),o(e,h)};y(Pt,t=>{m.report.coApprovals&&m.report.coApprovals.length>0&&m.report.votingPatterns&&t(Lt)}),n((t,e,r,n,o)=>{a(z,"href",t),f(R,m.report.info.jurisdictionName),f(V,` ${m.report.info.officeName??""}`),f(ot,e),f(vt,x),f(wt,r),f($t,n),f(At,o)},[()=>L("/"),()=>function(t){let e=new Date(t);return`${["January","February","March","April","May","June","July","August","September","October","November","December"][e.getUTCMonth()]} ${e.getUTCDate()}, ${e.getUTCFullYear()}`}(m.report.info.date),()=>m.report.ballotCount.toLocaleString(),()=>h.toLocaleString(),()=>(h/m.report.ballotCount).toFixed(1)]),o(e,N),s()}var at=x('<meta name="twitter:card" content="summary_large_image"/> <meta name="twitter:site" content="@felixsargent"/> <meta name="twitter:creator" content="@felixsargent"/> <meta name="twitter:title"/> <meta name="twitter:description"/> <meta name="twitter:image"/> <meta name="twitter:image:alt" content="Election results visualization showing approval voting outcomes"/> <meta property="og:type" content="article"/> <meta property="og:url"/> <meta property="og:title"/> <meta property="og:description"/> <meta property="og:image"/>',1),rt=x('<div class="wide container"><!> <hr/> <div class="row"><p style="font-style: italic;">This report was generated by <a>approval.vote</a> and may be reproduced under <a href="https://creativecommons.org/licenses/by/2.0/">CC-BY</a>. Learn more <a>about approval.vote</a>. <span style="margin-left: 1em;"><a>View card image →</a></span></p></div></div> <a style="display:none;">card</a>',1);function nt(e,r){t(r,!0);let l=r.data.report,v=r.data.path;var p=rt();N(t=>{var e=at(),r=c(w(e),6),s=c(r,2),i=c(s,2),d=c(i,6),p=c(d,2),u=c(p,2),g=c(u,2);n((t,e,n)=>{B.title=`approval.vote: ${l.info.jurisdictionName??""} / ${l.info.name??""} / ${t??""}`,a(r,"content",`${l.info.jurisdictionName??""} / ${l.info.name??""}`),a(s,"content",`Detailed approval voting election results for ${l.info.jurisdictionName??""} ${l.info.name??""} (${e??""})`),a(i,"content",`https://approval.vote/images/${v??""}.png`),a(d,"content",`https://approval.vote/report/${v??""}`),a(p,"content",`${l.info.jurisdictionName??""} / ${l.info.name??""}`),a(u,"content",`Detailed approval voting election results for ${l.info.jurisdictionName??""} ${l.info.name??""} (${n??""})`),a(g,"content",`https://approval.vote/images/${v??""}.png`)},[()=>l.info.date.slice(0,4),()=>l.info.date.slice(0,4),()=>l.info.date.slice(0,4)]),o(t,e)});var u=w(p),g=i(u);et(g,{get report(){return l}});var f=c(g,4),m=i(f),h=c(i(m)),b=c(h,4),y=c(b,2),$=i(y);d(y),d(m),d(f),d(u);var x=c(u,2);n((t,e,r,n)=>{a(h,"href",t),a(b,"href",e),a($,"href",r),a(x,"href",n)},[()=>L("/"),()=>L("/about"),()=>L(`/images/${v}.png`),()=>L(`/card/${v}`)]),o(e,p),s()}export{nt as component};
