import{aJ as t,bA as e,bb as a,bj as o,b3 as r,aW as n,aX as s,aV as i,a_ as l,bk as v,a$ as c,bB as d,aO as p,by as u,bC as g,b4 as m,bD as f,bE as b,aY as h,aT as w,aU as $,b1 as y,aS as x,bx as C,b2 as A,bF as L,ba as N,b9 as P,b6 as D,bh as j}from"../chunks/Bbgp51V2.js";var B=e("<rect></rect>"),T=e('<g><text font-size="90%" text-anchor="end" dominant-baseline="middle" class="svelte-enbeio"> </text><g></g><text font-size="90%" dominant-baseline="middle" class="svelte-enbeio"> </text></g>'),F=e('<svg width="100%"><g><line stroke="#666" stroke-width="1" stroke-dasharray="2,2" opacity="0.5"></line><!></g></svg>');function O(t,e){if(null===e)return;f(t,{content:e,allowHTML:!0,theme:"light-border",plugins:[b],followCursor:!0})}var S=x('<td class="colLabel approval-col-label svelte-hluumv"><div class="svelte-hluumv"> </div></td>'),k=x('<td class="entry svelte-hluumv"><!></td>'),M=x('<tr><td class="rowLabel svelte-hluumv"> <div class="voter-count svelte-hluumv"> </div></td><!></tr>'),R=x('<table class="svelte-hluumv"><tbody><tr><td></td><td class="colsLabel svelte-hluumv">Number of Candidates Approved</td></tr><tr><td class="rowsLabel svelte-hluumv"><div class="svelte-hluumv">Candidate</div></td><td></td><!></tr><!></tbody></table>');var E=x('<td class="colLabel svelte-16rbi9a"><div class="svelte-16rbi9a"> </div></td>'),I=x('<td class="entry svelte-16rbi9a"><!></td>'),z=x('<tr><td class="rowLabel svelte-16rbi9a"> </td><!></tr>'),V=x('<table class="svelte-16rbi9a"><tbody><tr><td></td><td class="colsLabel svelte-16rbi9a">Also approved</td></tr><tr><td class="rowsLabel svelte-16rbi9a"><div class="svelte-16rbi9a">Approved</div></td><td></td><!></tr><!></tbody></table>');var H=e('<g><text font-size="90%" text-anchor="end" dominant-baseline="middle" class="svelte-8b1303"> </text><g><rect class="exclusions svelte-8b1303"></rect></g><text font-size="90%" dominant-baseline="middle" class="svelte-8b1303"> </text></g>'),J=x('<div class="anyone-but-chart svelte-8b1303"><div class="chart-title svelte-8b1303">Anyone but...</div> <svg width="100%"><g><line stroke="#666" stroke-width="1" stroke-dasharray="2,2" opacity="0.5"></line><!></g></svg></div>'),U=x('<div class="no-data svelte-8b1303">No "Anyone But" voting patterns detected (no ballots with exactly N-1 approvals)</div>');var Y=x("<a> </a>"),_=x("<strong> </strong>"),W=x(", and <strong> </strong>",1),X=x(", <strong> </strong>",1),q=x("<p><strong> </strong> </p>"),G=x('<div class="row"><div class="leftCol"><h2>"Anyone But" Analysis</h2> <p>This shows which candidates were excluded when voters approved all candidates except one.\n      These ballots reveal strong opposition patterns, where voters are saying\n      "I\'ll support anyone except this candidate."</p> <!></div> <div class="rightCol"><!></div></div>'),K=x('<div class="row"><div class="leftCol"><h2>Approval Distribution</h2> <p>This shows how many candidates voters approved, both overall and broken down by\n      each candidate\'s supporters. This reveals whether some candidates attracted voters\n      who approved multiple candidates versus those who approved fewer candidates.\n      In approval voting, voters can select as many candidates as they wish.</p></div> <div class="rightCol"><!></div></div> <div class="row"><div class="leftCol"><h2>Co-Approval Matrix</h2> <p>For every pair of candidates, this table shows the fraction of voters who\n      approved one candidate that also approved the other. This reveals voting\n      patterns and candidate coalitions.</p></div> <div class="rightCol"><!></div></div> <!>',1),Q=x('<div class="row"><p class="description"></p> <div class="electionHeader"><h1><a>approval.vote</a> // <strong> </strong> </h1></div></div> <div class="row"><div class="leftCol"><p>The <!> was held on <strong> </strong>. <!> <!> <strong> </strong> <!>. <!></p> <p>There were <strong> </strong> ballots, with <strong> </strong> approvals. There was an average of <strong> </strong> approvals per ballot in this race.</p></div> <div class="rightCol"><!></div></div> <!>',1);function Z(e,x){t(x,!0),L("candidates",{getCandidate:function(t){return x.report.candidates[t]}});const D=x.report.candidates.map(t=>t.votes).reduce((t,e)=>t+e),j=x.report.candidates.filter(t=>!t.writeIn).length;var Z=Q(),tt=w(Z),et=i(l(tt),2),at=l(et),ot=l(at),rt=i(ot,2),nt=l(rt,!0);c(rt);var st=i(rt);c(at),c(et),c(tt);var it=i(tt,2),lt=l(it),vt=l(lt),ct=i(l(vt)),dt=t=>{var e=Y(),o=l(e);c(e),r(()=>{a(e,"href",x.report.info.website),m(o,`${x.report.info.jurisdictionName??""}\n          ${x.report.info.electionName??""}`)}),n(t,e)},pt=t=>{var e=A();r(()=>m(e,`${x.report.info.jurisdictionName??""} ${x.report.info.electionName??""}`)),n(t,e)};$(ct,t=>{x.report.info.website?t(dt):t(pt,!1)});var ut=i(ct,2),gt=l(ut,!0);c(ut);var mt=i(ut,2);o(mt,17,()=>{return 1==(t=x.report.candidates).length?[x.report.candidates[0]]:t.filter(t=>!0===t.winner).sort((t,e)=>e.votes-t.votes);var t},v,(t,e,a)=>{var o=h(),s=w(o),v=t=>{var a=_(),o=l(a,!0);c(a),r(()=>m(o,p(e).name)),n(t,a)},d=t=>{var o=h(),s=w(o),v=t=>{var a=W(),o=i(w(a)),s=l(o,!0);c(o),r(()=>m(s,p(e).name)),n(t,a)},d=t=>{var a=X(),o=i(w(a)),s=l(o,!0);c(o),r(()=>m(s,p(e).name)),n(t,a)};$(s,t=>{a==x.report.winners.length-1?t(v):t(d,!1)},!0),n(t,o)};$(s,t=>{0==a?t(v):t(d,!1)}),n(t,o)});var ft=i(mt,2),bt=t=>{var e=A("was the winner out of");n(t,e)},ht=t=>{var e=A("were the winners out of");n(t,e)};$(ft,t=>{1==x.report.winners.length?t(bt):t(ht,!1)});var wt=i(ft,2),$t=l(wt,!0);c(wt);var yt=i(wt,2),xt=t=>{var e=A("candidate");n(t,e)},Ct=t=>{var e=A("candidates");n(t,e)};$(yt,t=>{1==j?t(xt):t(Ct,!1)});var At=i(yt,2),Lt=t=>{var e=A();r(()=>m(e,x.report.info.notes)),n(t,e)};$(At,t=>{x.report.info.notes&&t(Lt)}),c(vt);var Nt=i(vt,2),Pt=i(l(Nt)),Dt=l(Pt,!0);c(Pt);var jt=i(Pt,2),Bt=l(jt,!0);c(jt);var Tt=i(jt,2),Ft=l(Tt,!0);c(Tt),P(),c(Nt),c(lt);var Ot=i(lt,2);!function(e,h){function w(t,e){null!==e&&f(t,{content:e,allowHTML:!0,theme:"light-border",plugins:[b],followCursor:!0})}t(h,!0);const $=[...h.report.candidates].sort((t,e)=>e.votes-t.votes),y=h.report.ballotCount,x=420/y,C=24*$.length,A={1:"#437527",2:"#5a8a35",3:"#6fa142",4:"#84b84f",5:"#99cf5c",6:"#aee669",7:"#c3fd76",8:"#c3fd76"};function L(t){return A[t]||"#c3fd76"}function N(t){const e=[];if(!h.report.votingPatterns?.candidateApprovalDistributions?.[t.name])return[{width:x*t.votes,color:"#437527",approvalCount:0,voteCount:t.votes}];const a=h.report.votingPatterns.candidateApprovalDistributions[t.name],o=Object.keys(a).map(Number).sort((t,e)=>t-e);for(const r of o){const t=a[r],o=x*t;e.push({width:o,color:L(r),approvalCount:r,voteCount:t})}return e}var P=F(),D=l(P);a(D,"transform","translate(130 0)");var j=l(D);a(j,"y1",0);var O=i(j);o(O,17,()=>$,v,(t,e,s)=>{var f=T();a(f,"transform",`translate(0 ${24*(s+.5)})`);var b=l(f),h=l(b,!0);c(b),d(b,(t,e)=>w?.(t,e),()=>`<strong>${p(e).name}</strong><br/>\n          <strong>${p(e).votes.toLocaleString()}</strong> total votes<br/>\n          ${(p(e).votes/y*100).toFixed(1)}% of all ballots cast`);var $=i(b);a($,"transform","translate(5 -8)"),o($,21,()=>N(p(e)),v,(t,o,s)=>{var i=B();a(i,"height",14),d(i,(t,e)=>w?.(t,e),()=>p(o).approvalCount>0?`<strong>${p(e).name}</strong><br/>\n              <strong>${p(o).voteCount.toLocaleString()}</strong> votes from ballots with <strong>${p(o).approvalCount}</strong> approval${1===p(o).approvalCount?"":"s"}<br/>\n              ${(p(o).voteCount/p(e).votes*100).toFixed(1)}% of ${p(e).name}'s total votes`:`<strong>${p(e).name}</strong><br/>\n              <strong>${p(e).votes.toLocaleString()}</strong> total votes<br/>\n              ${(p(e).votes/y*100).toFixed(1)}% of all ballots cast`),r(t=>{a(i,"width",p(o).width),a(i,"x",t),a(i,"fill",p(o).color)},[()=>0===s?0:N(p(e)).slice(0,s).reduce((t,e)=>t+e.width,0)]),n(t,i)}),c($);var C=i($),A=l(C);c(C),c(f),r(t=>{u(f,0,g(!0===p(e).winner?"":"eliminated"),"svelte-enbeio"),m(h,p(e).name),a(C,"x",10+x*p(e).votes),m(A,`${t??""}%`)},[()=>(p(e).votes/y*100).toFixed(1)]),n(t,f)}),c(D),c(P),r(()=>{a(P,"viewBox",`0 0 600 ${C}`),a(j,"x1",x*y),a(j,"x2",x*y),a(j,"y2",C)}),n(e,P),s()}(l(Ot),{get report(){return x.report}}),c(Ot),c(it);var St=i(it,2),kt=e=>{var L=K(),N=w(L),P=i(l(N),2),D=l(P);{let e=y(()=>x.report.candidates.map(t=>t.name));!function(e,f){t(f,!0);const b=y(()=>()=>f.votingPatterns?.candidateApprovalDistributions?f.candidates.map(t=>{const e=f.votingPatterns.candidateApprovalDistributions?.[t];return{name:t,votes:e?Object.values(e).reduce((t,e)=>t+e,0):0}}).sort((t,e)=>e.votes-t.votes).map(t=>t.name):[...f.candidates]),x=y(()=>()=>{const t=[];if(f.votingPatterns?.approvalDistribution&&f.votingPatterns?.candidateApprovalDistributions){const e={},a=f.votingPatterns.totalBallots;Object.entries(f.votingPatterns.approvalDistribution).forEach(([t,o])=>{const r=parseInt(t);e[r]={count:o,percentage:o/a*100}}),t.push({candidateName:"All Candidates",isOverall:!0,totalVoters:a,distributions:e});for(const o of p(b)()){const e=f.votingPatterns.candidateApprovalDistributions[o];if(!e)continue;const a=Object.values(e).reduce((t,e)=>t+e,0),r={};Object.entries(e).forEach(([t,e])=>{const o=parseInt(t);r[o]={count:e,percentage:e/a*100}}),t.push({candidateName:o,isOverall:!1,totalVoters:a,distributions:r})}}return t}),L=y(()=>()=>{let t=0;return f.votingPatterns?.approvalDistribution&&Object.keys(f.votingPatterns.approvalDistribution).forEach(e=>{t=Math.max(t,parseInt(e))}),t});var N=h(),P=w(N),D=t=>{const e=y(()=>p(x)()),s=y(()=>p(L)());var f=R(),b=l(f),h=l(b),w=i(l(h));c(h);var N=i(h),P=l(N),D=i(P,2);o(D,17,()=>Array.from({length:p(s)},(t,e)=>e+1),v,(t,e)=>{var a=S(),o=l(a),s=l(o,!0);c(o),c(a),r(()=>m(s,p(e))),n(t,a)}),c(N);var j=i(N);o(j,17,()=>p(e),v,(t,e)=>{var a=M(),f=l(a),b=l(f),h=i(b),w=l(h);c(h),c(f);var y=i(f);o(y,17,()=>Array.from({length:p(s)},(t,e)=>e+1),v,(t,a)=>{var o=k(),s=l(o),i=t=>{var o=A();r(t=>m(o,`${t??""}%`),[()=>p(e).distributions[p(a)].percentage.toFixed(1)]),n(t,o)},v=t=>{var e=A("—");n(t,e)};$(s,t=>{p(e).distributions[p(a)]?t(i):t(v,!1)}),c(o),d(o,(t,e)=>O?.(t,e),()=>p(e).distributions[p(a)]?function(t,e){const a=t.distributions[e];return a?`${t.candidateName}: ${a.count.toLocaleString()} voters (${a.percentage.toFixed(1)}%) approved exactly ${e} candidate${1!==e?"s":""}`:""}(p(e),p(a)):null),r(()=>C(o,p(e).distributions[p(a)]?`--percentage: ${p(e).distributions[p(a)].percentage}`:"")),n(t,o)}),c(a),r(t=>{u(a,1,g(p(e).isOverall?"overall-separator":""),"svelte-hluumv"),m(b,`${p(e).candidateName??""} `),m(w,`(${t??""} voters)`)},[()=>p(e).totalVoters.toLocaleString()]),n(t,a)}),c(b),c(f),r(()=>{a(w,"colspan",p(s)+1),a(P,"rowspan",p(e).length+1)}),n(t,f)};$(P,t=>{p(x)().length>0&&t(D)}),n(e,N),s()}(D,{get candidates(){return p(e)},get votingPatterns(){return x.report.votingPatterns}})}c(P),c(N);var j=i(N,2),B=i(l(j),2),T=l(B);{let e=y(()=>x.report.candidates.map(t=>t.name));!function(e,u){t(u,!0);const g=y(()=>()=>u.votingPatterns?.candidateApprovalDistributions?u.candidates.map(t=>{const e=u.votingPatterns.candidateApprovalDistributions?.[t];return{name:t,votes:e?Object.values(e).reduce((t,e)=>t+e,0):0}}).sort((t,e)=>e.votes-t.votes).map(t=>t.name):[...u.candidates]),f=y(()=>()=>({rows:p(g)().map((t,e)=>e),cols:p(g)().map((t,e)=>e),entries:p(g)().map((t,e)=>p(g)().map((a,o)=>{if(e===o)return null;const r=u.coApprovals.find(e=>e.candidateA.toLowerCase()===t.toLowerCase()&&e.candidateB.toLowerCase()===a.toLowerCase());return r?{frac:r.coApprovalRate/100,numerator:r.coApprovalCount,denominator:Math.round(r.coApprovalCount/(r.coApprovalRate/100))}:null}))})),b=y(()=>()=>{let t=0;return p(f)().entries.forEach(e=>{e.forEach(e=>{e&&e.frac>t&&(t=e.frac)})}),t});var h=V(),w=l(h),x=l(w),L=i(l(x));c(x);var N=i(x),P=l(N),D=i(P,2);o(D,17,()=>p(g)(),v,(t,e)=>{var a=E(),o=l(a),s=l(o,!0);c(o),c(a),r(()=>m(s,p(e))),n(t,a)}),c(N);var j=i(N);o(j,17,()=>p(g)(),v,(t,e,a)=>{var s=z(),u=l(s),h=l(u,!0);c(u);var w=i(u);o(w,17,()=>p(g)(),v,(t,o,s)=>{const i=y(()=>p(f)().entries[a][s]);var v=I(),u=l(v),g=t=>{var e=A();r(t=>m(e,`${t??""}%`),[()=>Math.round(1e3*p(i).frac)/10]),n(t,e)},h=t=>{var e=A("—");n(t,e)};$(u,t=>{p(i)?t(g):t(h,!1)}),c(v),d(v,(t,e)=>O?.(t,e),()=>p(i)?function(t,e,a){return`${(100*a.frac).toFixed(1)}% of ${t} voters also approved ${e} (${a.numerator.toLocaleString()} of ${a.denominator.toLocaleString()})`}(p(e),p(o),p(i)):null),r(t=>C(v,t),[()=>p(i)?`--frac: ${p(i).frac}; --max-frac: ${p(b)()}`:""]),n(t,v)}),c(s),r(()=>m(h,p(e))),n(t,s)}),c(w),c(h),r((t,e)=>{a(L,"colspan",t),a(P,"rowspan",e)},[()=>p(g)().length,()=>p(g)().length+1]),n(e,h),s()}(T,{get coApprovals(){return x.report.coApprovals},get candidates(){return p(e)},get votingPatterns(){return x.report.votingPatterns}})}c(B),c(j);var F=i(j,2),Y=e=>{var u=G(),g=l(u),C=i(l(g),4),A=t=>{const e=y(()=>Object.values(x.report.votingPatterns.anyoneButAnalysis).reduce((t,e)=>t+e,0));var a=q(),o=l(a),s=l(o,!0);c(o);var v=i(o);c(a),r((t,e)=>{m(s,t),m(v,` ballots approved all but one candidate\n        (${e??""}% of all ballots).`)},[()=>p(e).toLocaleString(),()=>(p(e)/x.report.ballotCount*100).toFixed(1)]),n(t,a)};$(C,t=>{x.report.votingPatterns?.anyoneButAnalysis&&t(A)}),c(g);var L=i(g,2),N=l(L);{let e=y(()=>x.report.candidates.map(t=>t.name));!function(e,u){function g(t,e){null!==e&&f(t,{content:e,allowHTML:!0,theme:"light-border",plugins:[b],followCursor:!0})}t(u,!0);const x=y(()=>()=>{if(!u.votingPatterns?.anyoneButAnalysis)return null;const t=u.votingPatterns.totalBallots||0,e=u.candidates.map(e=>{const a=u.votingPatterns.anyoneButAnalysis[e];if(a&&"number"!=typeof a)return{name:e,exclusionCount:a.exclusionCount||0,exclusionRate:100*(a.exclusionRate||0),overallRate:100*(a.overallRate||0)};{const o="number"==typeof a?a:0;return{name:e,exclusionCount:o,exclusionRate:t>0?o/t*100:0,overallRate:t>0?o/t*100:0}}}).sort((t,e)=>e.exclusionCount-t.exclusionCount),a=e.reduce((t,e)=>t+e.exclusionCount,0);return 0===a?null:{data:e,totalExclusions:a,totalBallots:t,scale:420/t}}),C=y(()=>()=>{const t=p(x)();return t?24*t.data.length:0});var A=h(),L=w(A),N=t=>{const e=y(()=>p(x)());var s=J(),u=i(l(s),2),f=l(u);a(f,"transform","translate(130 0)");var b=l(f);a(b,"y1",0);var h=i(b);o(h,17,()=>p(e).data,v,(t,o,s)=>{const v=y(()=>`<strong>${p(o).name}</strong><br/>\n              <strong>${p(o).exclusionCount.toLocaleString()}</strong> ballots excluded this candidate<br/>\n              ${p(o).overallRate.toFixed(1)}% of all ballots cast`);var u=H();a(u,"transform",`translate(0 ${24*(s+.5)})`);var f=l(u),b=l(f,!0);c(f),d(f,(t,e)=>g?.(t,e),()=>p(v));var h=i(f);a(h,"transform","translate(5 -8)");var w=l(h);a(w,"height",14),d(w,(t,e)=>g?.(t,e),()=>p(v)),c(h);var $=i(h),x=l($);c($),c(u),r(t=>{m(b,p(o).name),a(w,"width",p(e).scale*p(o).exclusionCount),a($,"x",10+p(e).scale*p(o).exclusionCount),m(x,`${t??""}%`)},[()=>p(o).overallRate.toFixed(1)]),n(t,u)}),c(f),c(u),c(s),r((t,o)=>{a(u,"viewBox",t),a(b,"x1",p(e).scale*p(e).totalBallots),a(b,"x2",p(e).scale*p(e).totalBallots),a(b,"y2",o)},[()=>`0 0 600 ${p(C)()}`,()=>p(C)()]),n(t,s)},P=t=>{var e=U();n(t,e)};$(L,t=>{p(x)()?t(N):t(P,!1)}),n(e,A),s()}(N,{get candidates(){return p(e)},get votingPatterns(){return x.report.votingPatterns}})}c(L),c(u),n(e,u)};$(F,t=>{x.report.votingPatterns?.anyoneButAnalysis&&t(Y)}),n(e,L)};$(St,t=>{x.report.coApprovals&&x.report.coApprovals.length>0&&x.report.votingPatterns&&t(kt)}),r((t,e,o,r,n)=>{a(ot,"href",t),m(nt,x.report.info.jurisdictionName),m(st,` ${x.report.info.officeName??""}`),m(gt,e),m($t,j),m(Dt,o),m(Bt,r),m(Ft,n)},[()=>N("/"),()=>function(t){let e=new Date(t);return`${["January","February","March","April","May","June","July","August","September","October","November","December"][e.getUTCMonth()]} ${e.getUTCDate()}, ${e.getUTCFullYear()}`}(x.report.info.date),()=>x.report.ballotCount.toLocaleString(),()=>D.toLocaleString(),()=>(D/x.report.ballotCount).toFixed(1)]),n(e,Z),s()}var tt=x('<meta name="twitter:card" content="summary_large_image"/> <meta name="twitter:site" content="@felixsargent"/> <meta name="twitter:creator" content="@felixsargent"/> <meta name="twitter:title"/> <meta name="twitter:description"/> <meta name="twitter:image"/> <meta name="twitter:image:alt" content="Election results visualization showing approval voting outcomes"/> <meta property="og:type" content="article"/> <meta property="og:url"/> <meta property="og:title"/> <meta property="og:description"/> <meta property="og:image"/>',1),et=x('<div class="wide container"><!> <hr/> <div class="row"><p style="font-style: italic;">This report was generated by <a>approval.vote</a> and may be reproduced under <a href="https://creativecommons.org/licenses/by/2.0/">CC-BY</a>. Learn more <a>about approval.vote</a>. <span style="margin-left: 1em;"><a>View card image →</a></span></p></div></div> <a style="display:none;">card</a>',1);function at(e,o){t(o,!0);let v=o.data.report,d=o.data.path;var p=et();D(t=>{var e=tt(),o=i(w(e),6),s=i(o,2),l=i(s,2),c=i(l,6),p=i(c,2),u=i(p,2),g=i(u,2);r((t,e,r)=>{j.title=`approval.vote: ${v.info.jurisdictionName??""} / ${v.info.officeName??""} / ${t??""}`,a(o,"content",`${v.info.jurisdictionName??""} / ${v.info.officeName??""}`),a(s,"content",`Detailed approval voting election results for ${v.info.jurisdictionName??""} ${v.info.officeName??""} - ${v.info.electionName??""} (${e??""})`),a(l,"content",`https://approval.vote/images/${d??""}.png`),a(c,"content",`https://approval.vote/report/${d??""}`),a(p,"content",`${v.info.jurisdictionName??""} / ${v.info.officeName??""}`),a(u,"content",`Detailed approval voting election results for ${v.info.jurisdictionName??""} ${v.info.officeName??""} - ${v.info.electionName??""} (${r??""})`),a(g,"content",`https://approval.vote/images/${d??""}.png`)},[()=>v.info.date.slice(0,4),()=>v.info.date.slice(0,4),()=>v.info.date.slice(0,4)]),n(t,e)});var u=w(p),g=l(u);Z(g,{get report(){return v}});var m=i(g,4),f=l(m),b=i(l(f)),h=i(b,4),$=i(h,2),y=l($);c($),c(f),c(m),c(u);var x=i(u,2);r((t,e,o,r)=>{a(b,"href",t),a(h,"href",e),a(y,"href",o),a(x,"href",r)},[()=>N("/"),()=>N("/about"),()=>N(`/images/${d}.png`),()=>N(`/card/${d}`)]),n(e,p),s()}export{at as component};
