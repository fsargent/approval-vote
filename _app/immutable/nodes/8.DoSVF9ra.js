import{aJ as t,bz as e,ba as a,bi as r,b3 as n,aW as o,aX as s,a_ as i,bk as l,a$ as v,aV as d,bA as c,aO as p,by as u,bB as g,b4 as m,bC as f,bD as h,aY as b,aT as w,aU as y,b1 as $,aS as x,bx as A,b2 as C,bE as P,b9 as L,b8 as j,b6 as N,bg as B}from"../chunks/DNN-lO2W.js";var D=e('<g><text font-size="90%" text-anchor="end" dominant-baseline="middle"> </text><g><rect class="votes svelte-a7xju3"></rect></g><text font-size="90%" dominant-baseline="middle"> </text></g>'),T=e('<svg width="100%"><g></g></svg>');function O(t,e){if(null===e)return;f(t,{content:e,allowHTML:!0,theme:"light-border",plugins:[h],followCursor:!0})}var F=x('<td class="colLabel approval-col-label svelte-fan315"><div class="svelte-fan315"> </div></td>'),M=x('<td class="entry svelte-fan315"><!></td>'),S=x('<tr><td class="rowLabel svelte-fan315"> <div class="voter-count svelte-fan315"> </div></td><!></tr>'),E=x('<table class="svelte-fan315"><tbody><tr><td></td><td class="colsLabel svelte-fan315">Number of Candidates Approved</td></tr><tr><td class="rowsLabel svelte-fan315"><div class="svelte-fan315">Candidate</div></td><td></td><!></tr><!></tbody></table>');var k=x('<td class="colLabel svelte-1ncug9c"><div class="svelte-1ncug9c"> </div></td>'),z=x('<td class="entry svelte-1ncug9c"><!></td>'),I=x('<tr><td class="rowLabel svelte-1ncug9c"> </td><!></tr>'),R=x('<table class="svelte-1ncug9c"><tbody><tr><td></td><td class="colsLabel svelte-1ncug9c">Also approved</td></tr><tr><td class="rowsLabel svelte-1ncug9c"><div class="svelte-1ncug9c">Approved</div></td><td></td><!></tr><!></tbody></table>');function V(e,u){t(u,!0);const g=$(()=>()=>{var t;if(null==(t=u.votingPatterns)?void 0:t.candidateApprovalDistributions){return u.candidates.map(t=>{var e;const a=null==(e=u.votingPatterns.candidateApprovalDistributions)?void 0:e[t];return{name:t,votes:a?Object.values(a).reduce((t,e)=>t+e,0):0}}).sort((t,e)=>e.votes-t.votes).map(t=>t.name)}return[...u.candidates]}),f=$(()=>()=>({rows:p(g)().map((t,e)=>e),cols:p(g)().map((t,e)=>e),entries:p(g)().map((t,e)=>p(g)().map((a,r)=>{if(e===r)return null;const n=u.coApprovals.find(e=>e.candidateA.toLowerCase()===t.toLowerCase()&&e.candidateB.toLowerCase()===a.toLowerCase());return n?{frac:n.coApprovalRate/100,numerator:n.coApprovalCount,denominator:Math.round(n.coApprovalCount/(n.coApprovalRate/100))}:null}))})),h=$(()=>()=>{let t=0;return p(f)().entries.forEach(e=>{e.forEach(e=>{e&&e.frac>t&&(t=e.frac)})}),t});var b=R(),w=i(b),x=i(w),P=d(i(x));v(x);var L=d(x),j=i(L),N=d(j,2);r(N,17,()=>p(g)(),l,(t,e)=>{var a=k(),r=i(a),s=i(r,!0);v(r),v(a),n(()=>m(s,p(e))),o(t,a)}),v(L);var B=d(L);r(B,17,()=>p(g)(),l,(t,e,a)=>{var s=I(),u=i(s),b=i(u,!0);v(u);var w=d(u);r(w,17,()=>p(g)(),l,(t,r,s)=>{var l=z();const d=$(()=>p(f)().entries[a][s]);var u=i(l),g=t=>{var e=C();n(t=>m(e,`${t??""}%`),[()=>Math.round(1e3*p(d).frac)/10]),o(t,e)},b=t=>{var e=C("—");o(t,e)};y(u,t=>{p(d)?t(g):t(b,!1)}),v(l),c(l,(t,e)=>null==O?void 0:O(t,e),()=>p(d)?function(t,e,a){return`${(100*a.frac).toFixed(1)}% of ${t} voters also approved ${e} (${a.numerator.toLocaleString()} of ${a.denominator.toLocaleString()})`}(p(e),p(r),p(d)):null),n(t=>A(l,t),[()=>{return p(d)?"background: "+(t=p(d).frac,`hsl(99, 41%, ${function(t,e,a){return t*(1-a)+e*a}(97,65,p(h)()>0?t/p(h)():0)}%)`):"";var t}]),o(t,l)}),v(s),n(()=>m(b,p(e))),o(t,s)}),v(w),v(b),n((t,e)=>{a(P,"colspan",t),a(j,"rowspan",e)},[()=>p(g)().length,()=>p(g)().length+1]),o(e,b),s()}var H=e('<g><text font-size="90%" text-anchor="end" dominant-baseline="middle"> </text><g><rect class="exclusions svelte-1ds3g8f"></rect></g><text font-size="90%" dominant-baseline="middle"> </text></g>'),J=x('<div class="anyone-but-chart svelte-1ds3g8f"><div class="chart-title svelte-1ds3g8f">Anyone but...</div> <svg width="100%"><g></g></svg></div>'),U=x('<div class="no-data svelte-1ds3g8f">No "Anyone But" voting patterns detected (no ballots with exactly N-1 approvals)</div>');var Y=x("<a> </a>"),_=x("<strong> </strong>"),W=x(", and <strong> </strong>",1),X=x(", <strong> </strong>",1),q=x("<p><strong> </strong> </p>"),G=x('<div class="row"><div class="leftCol"><h2>"Anyone But" Analysis</h2> <p>This shows which candidates were excluded when voters approved all candidates except one.\n      These ballots reveal strong opposition patterns, where voters are saying\n      "I\'ll support anyone except this candidate."</p> <!></div> <div class="rightCol"><!></div></div>'),K=x('<div class="row"><div class="leftCol"><h2>Approval Distribution</h2> <p>This shows how many candidates voters approved, both overall and broken down by\n      each candidate\'s supporters. This reveals whether some candidates attracted voters\n      who approved multiple candidates versus those who approved fewer candidates.\n      In approval voting, voters can select as many candidates as they wish.</p></div> <div class="rightCol"><!></div></div> <div class="row"><div class="leftCol"><h2>Co-Approval Matrix</h2> <p>For every pair of candidates, this table shows the fraction of voters who\n      approved one candidate that also approved the other. This reveals voting\n      patterns and candidate coalitions.</p></div> <div class="rightCol"><!></div></div> <!>',1),Q=x('<div class="row"><p class="description"></p> <div class="electionHeader"><h1><a>approval.vote</a> // <strong> </strong> </h1></div></div> <div class="row"><div class="leftCol"><p>The <!> was held on <strong> </strong>. <!> <!> <strong> </strong> <!>. <!></p> <p>There were <strong> </strong> ballots, with <strong> </strong> approvals. There was an average of <strong> </strong> approvals per ballot in this race.</p></div> <div class="rightCol"><!></div></div> <!>',1);function Z(e,x){t(x,!0),P("candidates",{getCandidate:function(t){return x.report.candidates[t]}});const N=x.report.candidates.map(t=>t.votes).reduce((t,e)=>t+e),B=x.report.candidates.filter(t=>!t.writeIn).length;var k=Q(),z=w(k),I=d(i(z),2),R=i(I),Z=i(R),tt=d(Z,2),et=i(tt,!0);v(tt);var at=d(tt);v(R),v(I),v(z);var rt=d(z,2),nt=i(rt),ot=i(nt),st=d(i(ot)),it=t=>{var e=Y(),r=i(e);v(e),n(()=>{a(e,"href",x.report.info.website),m(r,`${x.report.info.jurisdictionName??""}\n          ${x.report.info.electionName??""}`)}),o(t,e)},lt=t=>{var e=C();n(()=>m(e,`${x.report.info.jurisdictionName??""} ${x.report.info.electionName??""}`)),o(t,e)};y(st,t=>{x.report.info.website?t(it):t(lt,!1)});var vt=d(st,2),dt=i(vt,!0);v(vt);var ct=d(vt,2);r(ct,17,()=>{return 1==(t=x.report.candidates).length?[x.report.candidates[0]]:t.filter(t=>!0===t.winner);var t},l,(t,e,a)=>{var r=b(),s=w(r),l=t=>{var a=_(),r=i(a,!0);v(a),n(()=>m(r,p(e).name)),o(t,a)},c=t=>{var r=b(),s=w(r),l=t=>{var a=W(),r=d(w(a)),s=i(r,!0);v(r),n(()=>m(s,p(e).name)),o(t,a)},c=t=>{var a=X(),r=d(w(a)),s=i(r,!0);v(r),n(()=>m(s,p(e).name)),o(t,a)};y(s,t=>{a==x.report.winners.length-1?t(l):t(c,!1)},!0),o(t,r)};y(s,t=>{0==a?t(l):t(c,!1)}),o(t,r)});var pt=d(ct,2),ut=t=>{var e=C("was the winner out of");o(t,e)},gt=t=>{var e=C("were the winners out of");o(t,e)};y(pt,t=>{1==x.report.winners.length?t(ut):t(gt,!1)});var mt=d(pt,2),ft=i(mt,!0);v(mt);var ht=d(mt,2),bt=t=>{var e=C("candidate");o(t,e)},wt=t=>{var e=C("candidates");o(t,e)};y(ht,t=>{1==B?t(bt):t(wt,!1)});var yt=d(ht,2),$t=t=>{var e=C();n(()=>m(e,x.report.info.notes)),o(t,e)};y(yt,t=>{x.report.info.notes&&t($t)}),v(ot);var xt=d(ot,2),At=d(i(xt)),Ct=i(At,!0);v(At);var Pt=d(At,2),Lt=i(Pt,!0);v(Pt);var jt=d(Pt,2),Nt=i(jt,!0);v(jt),j(),v(xt),v(nt);var Bt=d(nt,2);!function(e,b){function w(t,e){null!==e&&f(t,{content:e,allowHTML:!0,theme:"light-border",plugins:[h],followCursor:!0})}t(b,!0);const y=[...b.report.candidates].sort((t,e)=>e.votes-t.votes),$=Math.max(...y.map(t=>t.votes)),x=b.report.ballotCount,A=420/$,C=24*y.length;var P=T(),L=i(P);a(L,"transform","translate(130 0)"),r(L,21,()=>y,l,(t,e,r)=>{var s=D();a(s,"transform",`translate(0 ${24*(r+.5)})`);var l=i(s),f=i(l,!0);v(l);var h=d(l);a(h,"transform","translate(5 -8)");var b=i(h);a(b,"height",14),c(b,(t,e)=>null==w?void 0:w(t,e),()=>`<strong>${p(e).name}</strong>\n            received <strong>${p(e).votes.toLocaleString()}</strong> votes, ${(p(e).votes/x*100).toFixed(1)}% of the total ballots cast.</g>`),v(h);var y=d(h),$=i(y);v(y),v(s),n(t=>{u(s,0,g(!0===p(e).winner?"":"eliminated"),"svelte-a7xju3"),m(f,p(e).name),a(b,"width",A*p(e).votes),a(y,"x",10+A*p(e).votes),m($,`${t??""}%`)},[()=>(p(e).votes/x*100).toFixed(1)]),o(t,s)}),v(L),v(P),n(()=>a(P,"viewBox",`0 0 600 ${C}`)),o(e,P),s()}(i(Bt),{get report(){return x.report}}),v(Bt),v(rt);var Dt=d(rt,2),Tt=e=>{var P=K(),L=w(P),j=d(i(L),2),N=i(j);{let e=$(()=>x.report.candidates.map(t=>t.name));!function(e,f){t(f,!0);const h=$(()=>()=>{var t;return(null==(t=f.votingPatterns)?void 0:t.candidateApprovalDistributions)?f.candidates.map(t=>{var e;const a=null==(e=f.votingPatterns.candidateApprovalDistributions)?void 0:e[t];return{name:t,votes:a?Object.values(a).reduce((t,e)=>t+e,0):0}}).sort((t,e)=>e.votes-t.votes).map(t=>t.name):[...f.candidates]}),x=$(()=>()=>{var t,e;const a=[];if((null==(t=f.votingPatterns)?void 0:t.approvalDistribution)&&(null==(e=f.votingPatterns)?void 0:e.candidateApprovalDistributions)){const t={},e=f.votingPatterns.totalBallots;Object.entries(f.votingPatterns.approvalDistribution).forEach(([a,r])=>{const n=parseInt(a);t[n]={count:r,percentage:r/e*100}}),a.push({candidateName:"All Candidates",isOverall:!0,totalVoters:e,distributions:t});for(const r of p(h)()){const t=f.votingPatterns.candidateApprovalDistributions[r];if(!t)continue;const e=Object.values(t).reduce((t,e)=>t+e,0),n={};Object.entries(t).forEach(([t,a])=>{const r=parseInt(t);n[r]={count:a,percentage:a/e*100}}),a.push({candidateName:r,isOverall:!1,totalVoters:e,distributions:n})}}return a}),P=$(()=>()=>{var t;let e=0;return(null==(t=f.votingPatterns)?void 0:t.approvalDistribution)&&Object.keys(f.votingPatterns.approvalDistribution).forEach(t=>{e=Math.max(e,parseInt(t))}),e});var L=b(),j=w(L),N=t=>{var e=E();const s=$(()=>p(x)()),f=$(()=>p(P)());var h=i(e),b=i(h),w=d(i(b));v(b);var L=d(b),j=i(L),N=d(j,2);r(N,17,()=>Array.from({length:p(f)},(t,e)=>e+1),l,(t,e)=>{var a=F(),r=i(a),s=i(r,!0);v(r),v(a),n(()=>m(s,p(e))),o(t,a)}),v(L);var B=d(L);r(B,17,()=>p(s),l,(t,e)=>{var a=S(),s=i(a),h=i(s),b=d(h),w=i(b);v(b),v(s);var $=d(s);r($,17,()=>Array.from({length:p(f)},(t,e)=>e+1),l,(t,a)=>{var r=M(),s=i(r),l=t=>{var r=C();n(t=>m(r,`${t??""}%`),[()=>p(e).distributions[p(a)].percentage.toFixed(1)]),o(t,r)},d=t=>{var e=C("—");o(t,e)};y(s,t=>{p(e).distributions[p(a)]?t(l):t(d,!1)}),v(r),c(r,(t,e)=>null==O?void 0:O(t,e),()=>p(e).distributions[p(a)]?function(t,e){const a=t.distributions[e];return a?`${t.candidateName}: ${a.count.toLocaleString()} voters (${a.percentage.toFixed(1)}%) approved exactly ${e} candidate${1!==e?"s":""}`:""}(p(e),p(a)):null),n(()=>A(r,p(e).distributions[p(a)]?`background: hsl(99, 41%, ${97-.8*p(e).distributions[p(a)].percentage}%)`:"")),o(t,r)}),v(a),n(t=>{u(a,1,g(p(e).isOverall?"overall-separator":""),"svelte-fan315"),m(h,`${p(e).candidateName??""} `),m(w,`(${t??""} voters)`)},[()=>p(e).totalVoters.toLocaleString()]),o(t,a)}),v(h),v(e),n(()=>{a(w,"colspan",p(f)+1),a(j,"rowspan",p(s).length+1)}),o(t,e)};y(j,t=>{p(x)().length>0&&t(N)}),o(e,L),s()}(N,{get candidates(){return p(e)},get votingPatterns(){return x.report.votingPatterns}})}v(j),v(L);var B=d(L,2),D=d(i(B),2),T=i(D);{let t=$(()=>x.report.candidates.map(t=>t.name));V(T,{get coApprovals(){return x.report.coApprovals},get candidates(){return p(t)},get votingPatterns(){return x.report.votingPatterns}})}v(D),v(B);var k=d(B,2),z=e=>{var u=G(),g=i(u),A=d(i(g),4),C=t=>{var e=q();const a=$(()=>Object.values(x.report.votingPatterns.anyoneButAnalysis).reduce((t,e)=>t+e,0));var r=i(e),s=i(r,!0);v(r);var l=d(r);v(e),n((t,e)=>{m(s,t),m(l,` ballots approved all but one candidate\n        (${e??""}% of all ballots).`)},[()=>p(a).toLocaleString(),()=>(p(a)/x.report.ballotCount*100).toFixed(1)]),o(t,e)};y(A,t=>{var e;(null==(e=x.report.votingPatterns)?void 0:e.anyoneButAnalysis)&&t(C)}),v(g);var P=d(g,2),L=i(P);{let e=$(()=>x.report.candidates.map(t=>t.name));!function(e,u){function g(t,e){null!==e&&f(t,{content:e,allowHTML:!0,theme:"light-border",plugins:[h],followCursor:!0})}t(u,!0);const x=$(()=>()=>{var t;if(!(null==(t=u.votingPatterns)?void 0:t.anyoneButAnalysis))return null;const e=Object.values(u.votingPatterns.anyoneButAnalysis).reduce((t,e)=>t+e,0),a=u.votingPatterns.totalBallots||0;if(0===e)return null;const r=u.candidates.map(t=>({name:t,exclusionCount:u.votingPatterns.anyoneButAnalysis[t]||0,exclusionRate:e>0?(u.votingPatterns.anyoneButAnalysis[t]||0)/e*100:0,overallRate:a>0?(u.votingPatterns.anyoneButAnalysis[t]||0)/a*100:0})).sort((t,e)=>e.exclusionCount-t.exclusionCount),n=Math.max(...r.map(t=>t.exclusionCount));return{data:r,totalExclusions:e,totalBallots:a,maxExclusions:n,scale:420/n}}),A=$(()=>()=>{const t=p(x)();return t?24*t.data.length:0});var C=b(),P=w(C),L=t=>{var e=J();const s=$(()=>p(x)());var u=d(i(e),2),f=i(u);a(f,"transform","translate(130 0)"),r(f,21,()=>p(s).data,l,(t,e,r)=>{var l=H();a(l,"transform",`translate(0 ${24*(r+.5)})`);var u=i(l),f=i(u,!0);v(u);var h=d(u);a(h,"transform","translate(5 -8)");var b=i(h);a(b,"height",14),c(b,(t,e)=>null==g?void 0:g(t,e),()=>`<strong>${p(e).name}</strong> was excluded by <strong>${p(e).exclusionCount.toLocaleString()}</strong> voters who approved all other candidates, ${p(e).overallRate.toFixed(1)}% of all ballots cast.`),v(h);var w=d(h),y=i(w);v(w),v(l),n(t=>{m(f,p(e).name),a(b,"width",p(s).scale*p(e).exclusionCount),a(w,"x",10+p(s).scale*p(e).exclusionCount),m(y,`${t??""}%`)},[()=>p(e).exclusionRate.toFixed(1)]),o(t,l)}),v(f),v(u),v(e),n(t=>a(u,"viewBox",t),[()=>`0 0 600 ${p(A)()}`]),o(t,e)},j=t=>{var e=U();o(t,e)};y(P,t=>{p(x)()?t(L):t(j,!1)}),o(e,C),s()}(L,{get candidates(){return p(e)},get votingPatterns(){return x.report.votingPatterns}})}v(P),v(u),o(e,u)};y(k,t=>{var e;(null==(e=x.report.votingPatterns)?void 0:e.anyoneButAnalysis)&&t(z)}),o(e,P)};y(Dt,t=>{x.report.coApprovals&&x.report.coApprovals.length>0&&x.report.votingPatterns&&t(Tt)}),n((t,e,r,n,o)=>{a(Z,"href",t),m(et,x.report.info.jurisdictionName),m(at,` ${x.report.info.officeName??""}`),m(dt,e),m(ft,B),m(Ct,r),m(Lt,n),m(Nt,o)},[()=>L("/"),()=>function(t){let e=new Date(t);return`${["January","February","March","April","May","June","July","August","September","October","November","December"][e.getUTCMonth()]} ${e.getUTCDate()}, ${e.getUTCFullYear()}`}(x.report.info.date),()=>x.report.ballotCount.toLocaleString(),()=>N.toLocaleString(),()=>(N/x.report.ballotCount).toFixed(1)]),o(e,k),s()}var tt=x('<meta name="twitter:card" content="summary_large_image"/> <meta name="twitter:site" content="@felixsargent"/> <meta name="twitter:creator" content="@felixsargent"/> <meta name="twitter:title"/> <meta name="twitter:description"/> <meta name="twitter:image"/> <meta name="twitter:image:alt" content="Election results visualization showing approval voting outcomes"/> <meta property="og:type" content="article"/> <meta property="og:url"/> <meta property="og:title"/> <meta property="og:description"/> <meta property="og:image"/>',1),et=x('<div class="wide container"><!> <hr/> <div class="row"><p style="font-style: italic;">This report was generated by <a>approval.vote</a> and may be reproduced under <a href="https://creativecommons.org/licenses/by/2.0/">CC-BY</a>. Learn more <a>about approval.vote</a>. <span style="margin-left: 1em;"><a>View card image →</a></span></p></div></div> <a style="display:none;">card</a>',1);function at(e,r){t(r,!0);let l=r.data.report,c=r.data.path;var p=et();N(t=>{var e=tt(),r=d(w(e),6),s=d(r,2),i=d(s,2),v=d(i,6),p=d(v,2),u=d(p,2),g=d(u,2);n((t,e,n)=>{B.title=`approval.vote: ${l.info.jurisdictionName??""} / ${l.info.name??""} / ${t??""}`,a(r,"content",`${l.info.jurisdictionName??""} / ${l.info.name??""}`),a(s,"content",`Detailed approval voting election results for ${l.info.jurisdictionName??""} ${l.info.name??""} (${e??""})`),a(i,"content",`https://approval.vote/images/${c??""}.png`),a(v,"content",`https://approval.vote/report/${c??""}`),a(p,"content",`${l.info.jurisdictionName??""} / ${l.info.name??""}`),a(u,"content",`Detailed approval voting election results for ${l.info.jurisdictionName??""} ${l.info.name??""} (${n??""})`),a(g,"content",`https://approval.vote/images/${c??""}.png`)},[()=>l.info.date.slice(0,4),()=>l.info.date.slice(0,4),()=>l.info.date.slice(0,4)]),o(t,e)});var u=w(p),g=i(u);Z(g,{get report(){return l}});var m=d(g,4),f=i(m),h=d(i(f)),b=d(h,4),y=d(b,2),$=i(y);v(y),v(f),v(m),v(u);var x=d(u,2);n((t,e,r,n)=>{a(h,"href",t),a(b,"href",e),a($,"href",r),a(x,"href",n)},[()=>L("/"),()=>L("/about"),()=>L(`/images/${c}.png`),()=>L(`/card/${c}`)]),o(e,p),s()}export{at as component};
